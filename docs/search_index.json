[["index.html", "Técnicas de análisis regional para detectar clústeres industriales Una aplicación para México bajo la noción de complejo industrial Sección 1 Presentación", " Técnicas de análisis regional para detectar clústeres industriales Una aplicación para México bajo la noción de complejo industrial Jaime Prudencio Marzo de 2023 Sección 1 Presentación En este documento se expone el desarrollo del método para la construcción de complejos industriales regionales utilizado por Prudencio (2023). El método se divide en dos grandes pasos. En el primero, se construyen cadenas productivas a partir de la Matriz de Insumo Producto de 2013 de INEGI (2018a) con el enfoque de Feser y Bergman (2000) que recurren al análisis de conglomerados con componentes principales. En el segundo, siguiendo a Feser et al. (2005) e incorporando las observaciones de Anselin (2020) se identifican las cadenas productivas a nivel municipal a través de índices de asociación espacial local que usan información del personal ocupado de INEGI (2020b). References "],["sec2.html", "Sección 2 Identificación de las cadenas productivas 2.1 Breve exposición del método 2.2 Desarrollo del procedimiento 2.3 Análisis estructura compras 2.4 Análisis estructura ventas 2.5 Matrices de correlación 2.6 Max 2.7 Análisis por componentes principales", " Sección 2 Identificación de las cadenas productivas El objetivo es construir o identificar conjuntos de actividades económicas que, dada su similitud en sus patrones de compras y ventas intersectoriales, puedan ser considerados como cadenas productivas. Se recurre al procedimiento de Feser y Bergman (2000). La información utilizada corresponde la matriz de insumo producto de México de 2013 publicada por INEGI (2018a). 2.1 Breve exposición del método La matriz de insumo producto (MIP) es un instrumento que permite conocer las relaciones intersectoriales entre las actividades económicas que se desarrollan en una economía nacional a través del registro de las compras y ventas que se suceden entre ellas (INEGI, 2018a). La MIP proporciona el valor monetario de los bienes vendidos por la actividad de la fila \\(i\\) a la actividad de la columna \\(j\\), \\(a_{ij}\\), es decir, las ventas que realiza el sector \\(i\\) al sector \\(j\\). Sea \\(p\\) y \\(s\\) el valor del total de compras intermedias y ventas intermedias respectivamente; así, la relación entre cada par de actividades, \\(i\\) y \\(j\\) se puede sintetizar en cuatro coeficientes (Feser and Bergman, 2000, p. 6): \\[ x_{ij}=\\frac{a_{ij}}{p_j};\\\\ x_{ji}=\\frac{a_{ji}}{p_i};\\\\ y_{ij}=\\frac{a_{ij}}{s_j};\\\\ y_{ji}=\\frac{a_{ji}}{s_i} \\] A la letra, Feser y Bergman (2000: 5) explican de este modo los coeficientes anteriores: “\\(x_{ij};x_{ji}\\): compras de bienes intermedios hechos por \\(j\\) (\\(i\\)) a \\(i\\) (\\(j\\)) como proporción del total de compras de bienes intermedios de \\(j\\) (\\(i\\)). Un valor alto de \\(x_{ij}\\), por ejemplo, sugiere que la industria \\(j\\) depende de la industria \\(i\\) como una fuente de una gran proporción del total de sus insumos intermedios. \\(y_{ij}; y_{ji}\\): ventas de bienes intermedios de \\(i\\) (\\(j\\)) a \\(j\\) (\\(i\\)) como una proporción de las ventas totales de bienes intermedios de \\(i\\) (\\(j\\)). Un valor alto de \\(y_{ij}\\), por ejemplo, sugeriría que \\(i\\) depende de la industria \\(j\\) como mercado para una gran proporción de sus ventas totales de bienes intermedios”. Los coeficentes anteriores se pueden sintetian en dos matrices: \\(X\\) y \\(Y\\), llamadas matriz de proporciones de compras y matriz de proporciones de ventas, respectivamente. Sobre las matrices \\(X\\) y \\(Y\\) se desarrolla un análisis de correlación que consiste en construir cuatro matrices cuyos elementos corresponden al grado de asociación entre pares de actividades, digamos \\(l\\) y \\(m\\). De nuevo siguiendo a la letra a Feser y Bergman (2000: 5): “\\(r(x_l\\cdot x_m)\\): mide el grado en que las industrias \\(l\\) y \\(m\\) tienen patrones similares de compra de insumos. \\(r(y_l\\cdot y_m)\\): mide el grado en que la industrias \\(l\\) y \\(m\\) presentan patrones de venta de productos similares, es decir, el grado en que venden bienes a una combinación similar de compradores de insumos intermedios. \\(r(x_l\\cdot y_m)\\): mide el grado en que el patrón de compra de la industria \\(l\\) es similar al patrón de venta de la industria \\(m\\), es decir, el grado en que la industria \\(l\\) compra insumos de industrias a las que \\(m\\) suministra. \\(r(y_l\\cdot x_m)\\): mide el grado en que el patrón de compra de la industria \\(m\\) es similar al patrón de venta de la industria \\(l\\), es decir, el grado en que la industria \\(m\\) compra insumos de las industrias a las que \\(l\\) suministra”. Posteriormente, con las cuatro matrices obtenidas,se construye otra que contiene sólo los coeficientes de correlación más altos entre pares de actividades, dicha matriz da cuenta de las interacción más sólidas entre pares de actividades. Finalmente, para obtener los conjuntos que integran agrupamientos de actividades, se recurre al Análisis de Componentes Principales (PCA) a ésta última matriz. Como resultado y después de una cuidadosa observación, se obtienen agrupamientos de actividades que pueden ser definidos como cadenas productivas. 2.2 Desarrollo del procedimiento En esta sección se desarrolla el procedimiento anterior con información de la MIP de México para 2013 con información a nivel de rama de actividad, clasificada según el Sistema de Clasificación Industrial de América del Norte (INEGI, 2018b). Las librerías utilizadas y las funciones personalizadas son: library(readxl) library(tidyverse) ## ── Attaching packages ─────────── tidyverse 1.3.2 ── ## ✔ ggplot2 3.4.0 ✔ purrr 1.0.0 ## ✔ tibble 3.1.8 ✔ dplyr 1.0.10 ## ✔ tidyr 1.2.1 ✔ stringr 1.5.0 ## ✔ readr 2.1.3 ✔ forcats 0.5.2 ## ── Conflicts ────────────── tidyverse_conflicts() ── ## ✖ dplyr::filter() masks stats::filter() ## ✖ dplyr::lag() masks stats::lag() library(ggplot2) library(corrplot) ## corrplot 0.92 loaded library(psych) ## ## Attaching package: &#39;psych&#39; ## ## The following objects are masked from &#39;package:ggplot2&#39;: ## ## %+%, alpha library(kableExtra) ## ## Attaching package: &#39;kableExtra&#39; ## ## The following object is masked from &#39;package:dplyr&#39;: ## ## group_rows library(sf) ## Linking to GEOS 3.9.3, GDAL 3.5.2, PROJ 8.2.1; sf_use_s2() is TRUE library(rgeoda) ## Loading required package: digest library(tidyverse) source(&#39;Codigo/graficas.R&#39;) La carga de la base de datos: mip_rama &lt;- read_excel(&quot;Bases de datos/mip_rama.xlsx&quot;, sheet = &quot;base_rama&quot;) La matriz a nivel rama cuenta con una dimensión de 263, 266, es decir, 263 filas y 266 columnas. De las columnas, se han excluido los elementos que corresponden a la demanda agregada (consumo privado, consumo de gobierno, formación bruta de capital fijo, exportaciones, importaciones y variación de existencias), aunque se han conservado el total de demanda intermedia (di_tot) y la utilización de la producción interna a precios básicos (upipb, que es la suma de la demanda intermedia y la demanda agregada). Además, el renglón final, uetoni, corresponde al usos de la economía total de origen nacional e importado (total de compras). Una vez cargada la información, se construirán las dos matrices que caracterizan los patrones de compras \\(X:x_{ij};x_{ji}\\) y ventas \\(Y:y_{ij}; y_{ji}\\). La matriz con las proporciones de compras, \\(X\\) se construye como: #Crea un arreglo de datos que une dos elementos X&lt;- data.frame(mip_rama[,c(1:2)],#El primero es la selección de todas las filas de la matriz pero sólo las columnas 1 y 2 mip_rama[,c(5:ncol(mip_rama))] / as.vector(mip_rama[nrow(mip_rama),c(5:ncol(mip_rama))])) #El segundo es un cociente que divide cada elemento de la matriz, desde la columna 5 y en adelante entre el total de compras intermedias (`uetoni`), pero sólo a partir de la columna 5. #Asigna los nombres de las columnas, que se han perdido en el paso anterior, a la matriz X names(X)&lt;-names(mip_rama)[-c(3,4)] #Elimina la última fila que tenía los totales de compras por rama X &lt;- X %&gt;% filter(cve_rama!=&#39;uetoni&#39;,cve_rama!=&quot;8141&quot;) %&gt;% dplyr::select(-&quot;8141&quot;) X[is.na(X)]=0 # Sustituir los NA con cero En tanto, la matriz que caracteriza los patrones de ventas, \\(Y\\) se construye con: u&lt;-mip_rama$di_tot #Almacena el renglón de ventas totales, demanda intermedia Y&lt;-mip_rama %&gt;% mutate_at(names(mip_rama)[4:ncol(mip_rama)],funs((./u))) %&gt;% #Lleva a cabo la división requerida desde la columna 4 hasta el final, es decir, divide cada elemento de todas las filas entre el vector u dplyr::select(-upipb,-di_tot,-&quot;8141&quot;) %&gt;% # Elimina las columnas de las variables indicadas filter(cve_rama!=&#39;uetoni&#39;,cve_rama!=&quot;8141&quot;) ## Warning: `funs()` was deprecated in dplyr 0.8.0. ## ℹ Please use a list of either functions or lambdas: ## ## # Simple named list: list(mean = mean, median = ## median) ## ## # Auto named with `tibble::lst()`: ## tibble::lst(mean, median) ## ## # Using lambdas list(~ mean(., trim = .2), ~ ## median(., na.rm = TRUE)) Y[is.na(Y)]=0 # Sustituir los NA con cero Una vez que ya se han calculado las dos matrices que describen los patrones de compras y ventas, el siguiente paso es llevar a cabo el análisis de correlación. No obstante, antes de ello, se presenta el resultado de las matrices para el caso de las 10 ramas de actividad más importantes en términos de su participación porcentual en el usos de la economía total de origen nacional e importado (uetoni). Dichas ramas son: 4311 Comercio al por mayor de abarrotes y alimentos (7.9%) 3241 Fabricación de productos derivados del petróleo y del carbón (7.8%) 3363 Fabricación de partes para vehículos automotores (4.6%) 2111 Extracción de petróleo y gas (4.1%) 5613 Servicios de empleo (3.9%) 3251 Fabricación de productos químicos básicos (3.8%) 3344 Fabricación de componentes electrónicos (2.9%) 2211 Generación, transmisión y distribución de energía eléctrica (2.4%) 5311 Alquiler sin intermediación de bienes raíces (2.2%) 3261 Fabricación de productos de plástico (2.0%) 2.3 Análisis estructura compras 2.3.1 4311 grafica_barras(X,sec_1111) 2.3.2 3241 grafica_barras(X,sec_3241) 2.3.3 3363 grafica_barras(X,sec_3363) 2.3.4 2111 grafica_barras(X,sec_2111) 2.3.5 5613 grafica_barras(X,sec_5613) 2.3.6 3251 grafica_barras(X,sec_3251) 2.3.7 3344 grafica_barras(X,sec_3344) 2.3.8 2211 grafica_barras(X,sec_2211) 2.3.9 5311 grafica_barras(X,sec_5311) 2.3.10 3261 grafica_barras(X,sec_3261) 2.4 Análisis estructura ventas 2.4.1 4311 grafica_barras(Y,sec_4311) 2.4.2 3241 grafica_barras(Y,sec_3241) 2.4.3 3363 grafica_barras(Y,sec_3363) 2.4.4 2111 grafica_barras(Y,sec_2111) 2.4.5 5613 grafica_barras(Y,sec_5613) 2.4.6 3251 grafica_barras(Y,sec_3251) 2.4.7 3344 grafica_barras(Y,sec_3344) 2.4.8 2211 grafica_barras(Y,sec_2211) 2.4.9 5311 grafica_barras(Y,sec_5311) 2.4.10 3261 grafica_barras(Y,sec_3261) Ahora bien, con las matrices \\(X\\) y \\(Y\\) se lleva a cabo el análisis de correlación, del que se construyen cuatro matrices \\(A=r(x_l\\cdot x_m)\\), \\(B=r(y_l\\cdot y_m)\\), \\(C=r(x_l\\cdot y_m)\\) y \\(D=r(y_l\\cdot x_m)\\), mismas que se muestran a continuación con un mapa de calor. 2.5 Matrices de correlación 2.5.0.1 A XX&lt;-cor(X[,c(-1,-2)]) corrplot(XX, method = &#39;color&#39;, type=&#39;lower&#39;, tl.cex = 0.5) 2.5.1 B YY&lt;-cor(Y[,c(-1,-2)]) corrplot(YY, method = &#39;color&#39;, type=&#39;lower&#39;, tl.cex = 0.5) 2.5.2 C XY&lt;-cor(X[,c(-1,-2)],Y[,c(-1,-2)]) corrplot(XY, method = &#39;color&#39;, type=&#39;lower&#39;, tl.cex = 0.5) 2.5.3 D YX&lt;-cor(Y[,c(-1,-2)],X[,c(-1,-2)]) corrplot(YX, method = &#39;color&#39;, type=&#39;lower&#39;, tl.cex = 0.5) 2.6 Max Finalmente, del juego de matrices anterior, se construye una nueva matriz en que cada elemento corresponde al valor máximo correspondiente en las matrices previas. Esta última matriz, con la cual se llevará a cabo el análisis por componentes principales, se muestra también en un mapa de calor. Q1&lt;-ifelse(XX&gt;YY,XX,YY) Q2&lt;-ifelse(Q1&gt;XY,Q1,XY) Q3&lt;-ifelse(Q2&gt;YX,Q2,YX) max_rama&lt;-Q3 corrplot(max_rama, method = &#39;color&#39;, type=&#39;lower&#39;, tl.cex = 0.5) 2.7 Análisis por componentes principales El procedimiento, de forma sintética, se puede dividir en: Cálculo de los componentes principales (aplicación del PCA) Rotación de los componentes por varimax Delimitación del número de agrupamientos o cadenas según el número de componentes principales elegidos. Selección de las actividades que integran cada cadena con arreglo a los valores absolutos de las cargas. En R, el análisis por componentes principales se desarrolla con la función prcomp(). La matriz que será sometida a PCA está integrada por coeficientes de correlación. Se procede como: PCAramaCS &lt;- prcomp(max_rama, center = T, scale. = T) El objeto que acaba de ser creado es de tipo prcomp y está integrado por los siguientes elementos: sdev, rotation, center, scale, x. center y scale corresponden a los valores centrados y escalados, respectivamente, de la variable original. En tanto, el resto: x: contiene los componentes principales (las combinaciones lineales de las variables). Los valores de este elemento nos permitirán hacer una gráfica bidimencional (bi-plot) para tener una representación de todas las variables pero “sintetizadas” o “reducida en sus dimensiones”. sdev: corresponde a la desviación estándar de los componentes calculados. Sirve, cuando la elevamos al cuadrado, para conocer qué porcentaje de la variación de los datos originales es captada por cada componente. rotation: almacena las cargas (loading scores). Hay una carga para cada componente principal y para cada observación. Las cargas sirven para determinar qué sectores tienen el efecto más grande sobre el agrupamiento o cadena identificada. Uno de los objetivos pues de la aplicación del PCA es la reducción de dimensiones: sintetizar la riqueza informativa de la base de datos (261 variables, es decir, interrelaciones entre sectores por sus patrones de compras y ventas) reducidos a determinado número de componentes. Una representación bidimiencional (con sólo dos variables, que explican a penas 40% de la variabilidad de la información) de nuestra base de datos original se hace con el bi-plot: comp1&lt;-as.data.frame(PCAramaCS[[&quot;x&quot;]]) ramas &lt;- row.names(PCAramaCS[[&quot;x&quot;]]) comp1 &lt;- comp1 %&gt;% add_column(ramas) ggplot(comp1)+ geom_text(aes(x=PC1,y=PC2),label=ramas) Los sectores más cercanos son sectores más parecidos entre sí y aparecen más cerca, aunque sólo captando 40% de la variabilidad de la información original. Como se dijo, sdev sirve como criterio para la elección del número de componentes que mejor describe la información, ya sea a partir de la magnitud del eigenvalor (la desviación estándar elevada al cuadrado) cuyas componentes serán seleccionadas para la reducción de dimensiones si dicho valor es mayor a la unidad. Esto lo podemos observar a partir de gráfica de sedimentación, de la que hay dos versiones: i) absoluta: graficar el eigenvalor (la desviación estándar elevada al cuadrado) ii) relativa: graficar la proporción de la varianza explicada. #Versión con eigenvalores en términos absolutos plot(PCAramaCS$sdev^2, main=&#39;Gráfico de sedimentación&#39;, ylab=&#39;Valor propio&#39;, xlab=&#39;Componente principal&#39;, type=&#39;b&#39;, col=&#39;royalblue4&#39;) abline(h=1, lty=2, col=&#39;red&#39;) #Versión de proporción de varianza explicada pca.var &lt;- PCAramaCS$sdev^2 pca.var.per &lt;- round(pca.var/sum(pca.var)*100, 1) plot(pca.var.per, main=&#39;Gráfico de sedimentación&#39;, ylab=&#39;Porcentaje de variación&#39;, xlab=&#39;Componente principal&#39;, type=&#39;b&#39;) En el caso de lo que buscamos aquí, es decir, la identificación de determinado número de actividades que entre sí integran una cadena de valor, la decisión del número de componentes, es decir, del número de cadenas productivas, es hecha con arreglo a los siguientes criterios (Feser y Bergman, 2000): la proporción relativa de varianza que cada componente explica, el tamaño de los eigenvalores asociados, los diagramas de sedimentación. Al solicitar un resumen del objeto que contiene los resultados del PCA se tiene que: summary(PCAramaCS) ## Importance of components: ## PC1 PC2 PC3 PC4 PC5 PC6 PC7 ## Standard deviation 8.2545 6.1234 5.9909 4.20918 3.63584 3.10450 2.93679 ## Proportion of Variance 0.2611 0.1437 0.1375 0.06788 0.05065 0.03693 0.03304 ## Cumulative Proportion 0.2611 0.4047 0.5422 0.61012 0.66077 0.69770 0.73074 ## PC8 PC9 PC10 PC11 PC12 PC13 PC14 ## Standard deviation 2.7083 2.39576 2.3020 2.05813 1.96215 1.80301 1.75924 ## Proportion of Variance 0.0281 0.02199 0.0203 0.01623 0.01475 0.01246 0.01186 ## Cumulative Proportion 0.7589 0.78084 0.8011 0.81737 0.83212 0.84458 0.85643 ## PC15 PC16 PC17 PC18 PC19 PC20 PC21 ## Standard deviation 1.6558 1.58375 1.45555 1.37754 1.32794 1.2717 1.22359 ## Proportion of Variance 0.0105 0.00961 0.00812 0.00727 0.00676 0.0062 0.00574 ## Cumulative Proportion 0.8669 0.87655 0.88467 0.89194 0.89869 0.9049 0.91063 ## PC22 PC23 PC24 PC25 PC26 PC27 PC28 ## Standard deviation 1.14578 1.07045 1.0476 1.00823 0.99381 0.9559 0.93626 ## Proportion of Variance 0.00503 0.00439 0.0042 0.00389 0.00378 0.0035 0.00336 ## Cumulative Proportion 0.91566 0.92005 0.9243 0.92815 0.93193 0.9354 0.93879 ## PC29 PC30 PC31 PC32 PC33 PC34 PC35 ## Standard deviation 0.90890 0.86647 0.84488 0.82126 0.79773 0.7744 0.7580 ## Proportion of Variance 0.00317 0.00288 0.00273 0.00258 0.00244 0.0023 0.0022 ## Cumulative Proportion 0.94195 0.94483 0.94757 0.95015 0.95259 0.9549 0.9571 ## PC36 PC37 PC38 PC39 PC40 PC41 PC42 ## Standard deviation 0.71427 0.69892 0.67779 0.66954 0.6470 0.6248 0.62308 ## Proportion of Variance 0.00195 0.00187 0.00176 0.00172 0.0016 0.0015 0.00149 ## Cumulative Proportion 0.95904 0.96091 0.96267 0.96439 0.9660 0.9675 0.96898 ## PC43 PC44 PC45 PC46 PC47 PC48 PC49 ## Standard deviation 0.58857 0.58657 0.58515 0.56626 0.55120 0.5370 0.52153 ## Proportion of Variance 0.00133 0.00132 0.00131 0.00123 0.00116 0.0011 0.00104 ## Cumulative Proportion 0.97031 0.97162 0.97294 0.97416 0.97533 0.9764 0.97748 ## PC50 PC51 PC52 PC53 PC54 PC55 PC56 ## Standard deviation 0.50255 0.49461 0.48022 0.47190 0.4575 0.44424 0.42959 ## Proportion of Variance 0.00097 0.00094 0.00088 0.00085 0.0008 0.00076 0.00071 ## Cumulative Proportion 0.97844 0.97938 0.98026 0.98112 0.9819 0.98268 0.98338 ## PC57 PC58 PC59 PC60 PC61 PC62 PC63 ## Standard deviation 0.41995 0.40908 0.39821 0.39385 0.38082 0.37492 0.35672 ## Proportion of Variance 0.00068 0.00064 0.00061 0.00059 0.00056 0.00054 0.00049 ## Cumulative Proportion 0.98406 0.98470 0.98531 0.98590 0.98646 0.98700 0.98748 ## PC64 PC65 PC66 PC67 PC68 PC69 PC70 ## Standard deviation 0.35438 0.34697 0.33495 0.32897 0.3227 0.30602 0.29852 ## Proportion of Variance 0.00048 0.00046 0.00043 0.00041 0.0004 0.00036 0.00034 ## Cumulative Proportion 0.98796 0.98843 0.98886 0.98927 0.9897 0.99003 0.99037 ## PC71 PC72 PC73 PC74 PC75 PC76 PC77 ## Standard deviation 0.29644 0.29016 0.28665 0.2806 0.27635 0.27234 0.27061 ## Proportion of Variance 0.00034 0.00032 0.00031 0.0003 0.00029 0.00028 0.00028 ## Cumulative Proportion 0.99071 0.99103 0.99134 0.9917 0.99194 0.99222 0.99250 ## PC78 PC79 PC80 PC81 PC82 PC83 PC84 ## Standard deviation 0.26685 0.26271 0.25751 0.25195 0.24895 0.24579 0.24001 ## Proportion of Variance 0.00027 0.00026 0.00025 0.00024 0.00024 0.00023 0.00022 ## Cumulative Proportion 0.99278 0.99304 0.99329 0.99354 0.99377 0.99401 0.99423 ## PC85 PC86 PC87 PC88 PC89 PC90 PC91 ## Standard deviation 0.23710 0.23363 0.2285 0.22271 0.22201 0.21049 0.20349 ## Proportion of Variance 0.00022 0.00021 0.0002 0.00019 0.00019 0.00017 0.00016 ## Cumulative Proportion 0.99444 0.99465 0.9949 0.99504 0.99523 0.99540 0.99556 ## PC92 PC93 PC94 PC95 PC96 PC97 PC98 ## Standard deviation 0.19893 0.19846 0.19369 0.19130 0.18627 0.18392 0.17666 ## Proportion of Variance 0.00015 0.00015 0.00014 0.00014 0.00013 0.00013 0.00012 ## Cumulative Proportion 0.99571 0.99586 0.99600 0.99614 0.99628 0.99641 0.99653 ## PC99 PC100 PC101 PC102 PC103 PC104 PC105 ## Standard deviation 0.17456 0.17254 0.16980 0.16639 0.1628 0.1616 0.1583 ## Proportion of Variance 0.00012 0.00011 0.00011 0.00011 0.0001 0.0001 0.0001 ## Cumulative Proportion 0.99664 0.99676 0.99687 0.99697 0.9971 0.9972 0.9973 ## PC106 PC107 PC108 PC109 PC110 PC111 PC112 ## Standard deviation 0.15707 0.15226 0.15103 0.14911 0.14715 0.14400 0.13984 ## Proportion of Variance 0.00009 0.00009 0.00009 0.00009 0.00008 0.00008 0.00007 ## Cumulative Proportion 0.99737 0.99746 0.99754 0.99763 0.99771 0.99779 0.99787 ## PC113 PC114 PC115 PC116 PC117 PC118 PC119 ## Standard deviation 0.13809 0.13667 0.13411 0.13266 0.12791 0.12644 0.12618 ## Proportion of Variance 0.00007 0.00007 0.00007 0.00007 0.00006 0.00006 0.00006 ## Cumulative Proportion 0.99794 0.99801 0.99808 0.99815 0.99821 0.99827 0.99833 ## PC120 PC121 PC122 PC123 PC124 PC125 PC126 ## Standard deviation 0.12603 0.12322 0.11999 0.11765 0.11443 0.11233 0.11124 ## Proportion of Variance 0.00006 0.00006 0.00006 0.00005 0.00005 0.00005 0.00005 ## Cumulative Proportion 0.99839 0.99845 0.99851 0.99856 0.99861 0.99866 0.99870 ## PC127 PC128 PC129 PC130 PC131 PC132 PC133 ## Standard deviation 0.10845 0.10794 0.10674 0.10461 0.10207 0.10069 0.09862 ## Proportion of Variance 0.00005 0.00004 0.00004 0.00004 0.00004 0.00004 0.00004 ## Cumulative Proportion 0.99875 0.99879 0.99884 0.99888 0.99892 0.99896 0.99900 ## PC134 PC135 PC136 PC137 PC138 PC139 PC140 ## Standard deviation 0.09619 0.09402 0.09269 0.09170 0.09023 0.08882 0.08806 ## Proportion of Variance 0.00004 0.00003 0.00003 0.00003 0.00003 0.00003 0.00003 ## Cumulative Proportion 0.99903 0.99906 0.99910 0.99913 0.99916 0.99919 0.99922 ## PC141 PC142 PC143 PC144 PC145 PC146 PC147 ## Standard deviation 0.08707 0.08498 0.08283 0.08211 0.08056 0.07934 0.07820 ## Proportion of Variance 0.00003 0.00003 0.00003 0.00003 0.00002 0.00002 0.00002 ## Cumulative Proportion 0.99925 0.99928 0.99930 0.99933 0.99935 0.99938 0.99940 ## PC148 PC149 PC150 PC151 PC152 PC153 PC154 ## Standard deviation 0.07550 0.07392 0.07247 0.07173 0.07089 0.07047 0.06862 ## Proportion of Variance 0.00002 0.00002 0.00002 0.00002 0.00002 0.00002 0.00002 ## Cumulative Proportion 0.99942 0.99945 0.99947 0.99949 0.99950 0.99952 0.99954 ## PC155 PC156 PC157 PC158 PC159 PC160 PC161 ## Standard deviation 0.06776 0.06748 0.06550 0.06482 0.06347 0.06297 0.06202 ## Proportion of Variance 0.00002 0.00002 0.00002 0.00002 0.00002 0.00002 0.00001 ## Cumulative Proportion 0.99956 0.99958 0.99959 0.99961 0.99962 0.99964 0.99965 ## PC162 PC163 PC164 PC165 PC166 PC167 PC168 ## Standard deviation 0.06172 0.06059 0.06011 0.05894 0.05818 0.05671 0.05528 ## Proportion of Variance 0.00001 0.00001 0.00001 0.00001 0.00001 0.00001 0.00001 ## Cumulative Proportion 0.99967 0.99968 0.99970 0.99971 0.99972 0.99974 0.99975 ## PC169 PC170 PC171 PC172 PC173 PC174 PC175 ## Standard deviation 0.05403 0.05317 0.05278 0.05131 0.05044 0.04947 0.04867 ## Proportion of Variance 0.00001 0.00001 0.00001 0.00001 0.00001 0.00001 0.00001 ## Cumulative Proportion 0.99976 0.99977 0.99978 0.99979 0.99980 0.99981 0.99982 ## PC176 PC177 PC178 PC179 PC180 PC181 PC182 ## Standard deviation 0.04803 0.04774 0.04561 0.04405 0.04366 0.04226 0.04221 ## Proportion of Variance 0.00001 0.00001 0.00001 0.00001 0.00001 0.00001 0.00001 ## Cumulative Proportion 0.99983 0.99984 0.99984 0.99985 0.99986 0.99987 0.99987 ## PC183 PC184 PC185 PC186 PC187 PC188 PC189 ## Standard deviation 0.04164 0.04027 0.04009 0.03830 0.03743 0.03629 0.03511 ## Proportion of Variance 0.00001 0.00001 0.00001 0.00001 0.00001 0.00001 0.00000 ## Cumulative Proportion 0.99988 0.99988 0.99989 0.99990 0.99990 0.99991 0.99991 ## PC190 PC191 PC192 PC193 PC194 PC195 PC196 ## Standard deviation 0.03442 0.03397 0.03377 0.03347 0.03257 0.03229 0.03131 ## Proportion of Variance 0.00000 0.00000 0.00000 0.00000 0.00000 0.00000 0.00000 ## Cumulative Proportion 0.99992 0.99992 0.99993 0.99993 0.99993 0.99994 0.99994 ## PC197 PC198 PC199 PC200 PC201 PC202 PC203 ## Standard deviation 0.03026 0.02958 0.02902 0.02839 0.02716 0.02659 0.02598 ## Proportion of Variance 0.00000 0.00000 0.00000 0.00000 0.00000 0.00000 0.00000 ## Cumulative Proportion 0.99994 0.99995 0.99995 0.99995 0.99996 0.99996 0.99996 ## PC204 PC205 PC206 PC207 PC208 PC209 PC210 ## Standard deviation 0.02527 0.02482 0.02415 0.02385 0.0234 0.02223 0.02203 ## Proportion of Variance 0.00000 0.00000 0.00000 0.00000 0.0000 0.00000 0.00000 ## Cumulative Proportion 0.99997 0.99997 0.99997 0.99997 1.0000 0.99998 0.99998 ## PC211 PC212 PC213 PC214 PC215 PC216 PC217 ## Standard deviation 0.02091 0.0201 0.01931 0.01879 0.01788 0.01688 0.01674 ## Proportion of Variance 0.00000 0.0000 0.00000 0.00000 0.00000 0.00000 0.00000 ## Cumulative Proportion 0.99998 1.0000 0.99998 0.99998 0.99998 0.99999 0.99999 ## PC218 PC219 PC220 PC221 PC222 PC223 PC224 ## Standard deviation 0.01659 0.01583 0.01572 0.01536 0.01433 0.01386 0.01343 ## Proportion of Variance 0.00000 0.00000 0.00000 0.00000 0.00000 0.00000 0.00000 ## Cumulative Proportion 0.99999 0.99999 0.99999 0.99999 0.99999 0.99999 0.99999 ## PC225 PC226 PC227 PC228 PC229 PC230 PC231 ## Standard deviation 0.013 0.01289 0.01235 0.01157 0.01117 0.01054 0.01027 ## Proportion of Variance 0.000 0.00000 0.00000 0.00000 0.00000 0.00000 0.00000 ## Cumulative Proportion 1.000 0.99999 0.99999 1.00000 1.00000 1.00000 1.00000 ## PC232 PC233 PC234 PC235 PC236 PC237 ## Standard deviation 0.009803 0.009332 0.009039 0.008904 0.00833 0.00796 ## Proportion of Variance 0.000000 0.000000 0.000000 0.000000 0.00000 0.00000 ## Cumulative Proportion 1.000000 1.000000 1.000000 1.000000 1.00000 1.00000 ## PC238 PC239 PC240 PC241 PC242 PC243 ## Standard deviation 0.00699 0.006818 0.005887 0.005779 0.00572 0.005377 ## Proportion of Variance 0.00000 0.000000 0.000000 0.000000 0.00000 0.000000 ## Cumulative Proportion 1.00000 1.000000 1.000000 1.000000 1.00000 1.000000 ## PC244 PC245 PC246 PC247 PC248 PC249 ## Standard deviation 0.004535 0.004483 0.004318 0.003864 0.003476 0.003419 ## Proportion of Variance 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 ## Cumulative Proportion 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 ## PC250 PC251 PC252 PC253 PC254 PC255 ## Standard deviation 0.003185 0.002704 0.002629 0.002028 0.001655 0.001495 ## Proportion of Variance 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 ## Cumulative Proportion 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 ## PC256 PC257 PC258 PC259 PC260 ## Standard deviation 0.001263 0.001142 0.0008809 0.0003974 0.0002838 ## Proportion of Variance 0.000000 0.000000 0.0000000 0.0000000 0.0000000 ## Cumulative Proportion 1.000000 1.000000 1.0000000 1.0000000 1.0000000 ## PC261 ## Standard deviation 3.579e-15 ## Proportion of Variance 0.000e+00 ## Cumulative Proportion 1.000e+00 De donde es posible observar qué número de componentes explican determinado porcentaje de varianza, de forma semejante al gráfico de sedimentación. Antes de la rotación, el número de componentes (agrupamientos) que se considera adecuado es 25, los que explican 92% de la varianza y en todos ellos el tamaño del eigenvalor es mayor a 1. Según lo indicado por Feser y Bergman (2000), la selección de las actividades que integran cada cadena productiva se hace observando las cargas dentro de cada agrupamiento, es decir, los valores absolutos del elemento rotation. De nuevo, Feser y Bergman (2000): “el conjunto generado de cargas (loadings) provee una medida de la fuerza relativa de los vínculos entre una industria dada y el factor derivado, en donde las industrias con las cargas más altas de un factor dado son tratadas como miembros de una cadena productiva” (p. 4). En la práctica es común en el análisis factorial considerar como significativas o dignas de interpretación sólo aquellas cargas que son más grandes que 0.5 (en términos absolutos). Para la selección de las actividades que integrarán cada cadena productiva, los autores que seguimos buscan hacer un balance de los siguientes objetivos (p. 4): Identificar, mediante la magnitud de las cargas, los vínculos más estrechos de cada cluster, con independencia de si dicho sector está también vinculado estrechamente a otros cluster. Identificar, en la medida de lo posible, un conjunto de clusters mutuamente excluyentes, de modo que cada sector esté asignado a un solo cluster. Investigar los vínculos tanto entre clusteres como al interior de cada cluster. Así, respecto al objetivo 1, la elección de las actividades que integra cada cadena productiva es hecha a partir de la magnitud de la carga y los autores distinguen entre diferentes tipos de actividades: industrias primarias y secundarias. Las primarias son aquellas que, para una cadena, tienen un valor de la carga igual o mayor a 0.6, en tanto, una actividad secundaria es aquella que tiene una carga entre 0.35 y 0.6. No obstante, eso hay que hacerlo después de la rotación varimax. La librería psych permite seleccionar el método de rotación desde el cálculo de los componentes, a través de la función principal(). El siguiente segmento de código lleva a cabo el cálculo de los componentes principales rotados con varimax, donde se ha especificado que se desean 25 componentes, luego guarda las cargas en un dataframe para su análisis. PCAramaVM &lt;- principal(r=max_rama,nfactors = 25,rotate = &quot;varimax&quot;) ## Pearson correlations of the raw data were found ## Warning in cor.smooth(model): Matrix was not positive definite, smoothing was ## done ## Warning in cor.smooth(r): Matrix was not positive definite, smoothing was done ## Warning in log(det(m.inv.r)): Se han producido NaNs ## The determinant of the smoothed correlation was zero. ## This means the objective function is not defined for the null model either. ## The Chi square is thus based upon observed correlations. cargasPCA &lt;-cbind(nom_rama=X$nom_rama,data.frame(rama=row.names(max_rama),unclass(PCAramaVM$loadings))) De los 25 componentes (cadenas productivas) obtenidas, 9 de ellas corresponden a actividades industriales, por ello, se seleccionan las de interés a través del siguiente segmento de código: clusters&lt;-c(&#39;RC3&#39;,&#39;RC6&#39;,&#39;RC8&#39;,&#39;RC10&#39;,&#39;RC12&#39;,&#39;RC13&#39;,&#39;RC15&#39;,&#39;RC17&#39;,&#39;RC20&#39;) ramas_ci&lt;-cargasPCA %&gt;% dplyr::select(nom_rama,rama,RC3,RC6,RC8,RC10,RC12,RC13,RC15,RC17,RC20 ) Luego, esta información se apila para identificar más fácilmente las cargas y discriminar entre actividades que aparecen en varias cadenas simultáneamente: nc&lt;-ncol(ramas_ci)-2 remove(ramas_ci_row,cuadro) ## Warning in remove(ramas_ci_row, cuadro): objeto &#39;ramas_ci_row&#39; no encontrado ## Warning in remove(ramas_ci_row, cuadro): objeto &#39;cuadro&#39; no encontrado ramas_ci_row&lt;-data.frame() for (i in 1:nc){ n&lt;-i+2 selecion&lt;- ramas_ci %&gt;% dplyr::select(1,2,n) cuadro&lt;-custom_filtro(selecion) ramas_ci_row&lt;-rbind(ramas_ci_row,cuadro) } ## Warning: Using an external vector in selections was ## deprecated in tidyselect 1.1.0. ## ℹ Please use `all_of()` or `any_of()` instead. ## # Was: ## data %&gt;% select(n) ## ## # Now: ## data %&gt;% select(all_of(n)) ## ## See ## &lt;https://tidyselect.r-lib.org/reference/faq-external-vector.html&gt;. Las actividades que aparecen en más de una cadena aparecen con una cuenta mayor que uno en la siguiente tabla: Cuenta&lt;- ramas_ci_row %&gt;% count(rama) %&gt;% arrange(x=desc(n)) Cuenta ## rama n ## 1 8113 3 ## 2 2361 2 ## 3 2362 2 ## 4 3132 2 ## 5 3133 2 ## 6 3255 2 ## 7 3323 2 ## 8 3324 2 ## 9 3331 2 ## 10 3332 2 ## 11 3335 2 ## 12 3339 2 ## 13 3351 2 ## 14 3359 2 ## 15 3362 2 ## 16 3363 2 ## 17 3366 2 ## 18 3372 2 ## 19 2111 1 ## 20 2371 1 ## 21 2372 1 ## 22 2373 1 ## 23 2379 1 ## 24 2381 1 ## 25 2389 1 ## 26 3121 1 ## 27 3131 1 ## 28 3141 1 ## 29 3149 1 ## 30 3151 1 ## 31 3152 1 ## 32 3159 1 ## 33 3169 1 ## 34 3212 1 ## 35 3219 1 ## 36 3221 1 ## 37 3222 1 ## 38 3231 1 ## 39 3251 1 ## 40 3252 1 ## 41 3253 1 ## 42 3254 1 ## 43 3256 1 ## 44 3259 1 ## 45 3261 1 ## 46 3262 1 ## 47 3271 1 ## 48 3272 1 ## 49 3273 1 ## 50 3279 1 ## 51 3311 1 ## 52 3312 1 ## 53 3313 1 ## 54 3315 1 ## 55 3321 1 ## 56 3322 1 ## 57 3325 1 ## 58 3326 1 ## 59 3327 1 ## 60 3328 1 ## 61 3329 1 ## 62 3333 1 ## 63 3334 1 ## 64 3341 1 ## 65 3342 1 ## 66 3343 1 ## 67 3344 1 ## 68 3345 1 ## 69 3346 1 ## 70 3352 1 ## 71 3353 1 ## 72 3361 1 ## 73 3365 1 ## 74 3369 1 ## 75 3371 1 ## 76 3379 1 ## 77 3399 1 ## 78 4885 1 ## 79 4889 1 ## 80 5171 1 ## 81 5172 1 ## 82 5321 1 ## 83 5613 1 ## 84 5615 1 ## 85 5619 1 ## 86 5621 1 ## 87 8111 1 ## 88 8112 1 ## 89 8114 1 ## 90 8129 1 Dichas actividades duplicadas se asignan a la cadena donde tienen la mayor carga: ramas_ci_final&lt;-ramas_ci_row %&gt;% group_by (rama)%&gt;% filter (Carga == max (Carga, na.rm = TRUE )) Ahora, sólo queda una actividad por cadena, como se indica en los criterios dados por Feser y Bergman (2000) Cuenta2&lt;- ramas_ci_final %&gt;% count(rama) %&gt;% arrange(desc(n)) El conjunto de ramas vinculadas a cada una de las nueve cadenas obtenidas se muestra en el siguiente cuadro: Cuadro_cruster&lt;-ramas_ci_final %&gt;% dplyr::select(cluster,rama)%&gt;% group_by(cluster) %&gt;% summarise(ramas = paste(rama, collapse = &quot;, &quot;)) Cuadro_cruster %&gt;% arrange(factor(cluster, levels = clusters))%&gt;% kbl(caption = &quot;Ramas más fuertemente vinculadas&quot;) %&gt;% kable_styling() Table 2.1: Ramas más fuertemente vinculadas cluster ramas RC3 3311, 3312, 3313, 3315, 3321, 3322, 3323, 3324, 3325, 3327, 3328, 3329, 3331, 3334, 3335, 3339, 3352, 3362, 3365, 3366, 4889, 8113 RC6 2111, 3121, 3251, 3252, 3253, 3254, 3255, 3256, 3259, 3272, 5621 RC8 3332, 3333, 3341, 3342, 3343, 3344, 3345, 3351, 3353, 3359, 4885, 5171, 5172, 8112 RC10 3132, 3133, 3141, 3149, 3151, 3152, 3159, 3169, 3379 RC12 2361, 2362, 2371, 2372, 2373, 2379, 2381, 2389, 3271, 3273, 3279 RC13 3361, 3363, 3369, 5321, 8111, 8114 RC15 3221, 3222, 3231, 5613, 5615, 5619, 8129 RC17 3131, 3261, 3262, 3346, 3399 RC20 3212, 3219, 3326, 3371, 3372 References "],["sec3.html", "Sección 3 Identificación de los complejos con el indicador de asociación espacial local de Moran 3.1 Breve descripción del método 3.2 Fuentes de información 3.3 Desarrollo del método", " Sección 3 Identificación de los complejos con el indicador de asociación espacial local de Moran En esta sección se expone el procedimiento para la identificación de complejos industriales. La propuesta recurre al cálculo de coeficientes de autocorrelación espacial local de Moran, con base en la propuesta de Feser y Bergman (2005), adaptada a partir de las consideraciones de Anselin (2020). El objetivo es ubicar a nivel municipal las cadenas productivas industriales identificadas a través del método Feser y Bergman (2000) que fueron resultado del análisis por componentes principales del apartado anterior donde se identificaron 9 cadenas productivas industriales: Metalmecánica, Química, Eléctrico-electrónica, Textiles, confección y prendas de vestir, Construcción, Autotransportes, Papel e impresión, Plásticos y fibras sintéticas y Muebles y productos de madera que aparecen en la tabla anterior. 3.1 Breve descripción del método Siguiendo las ideas de Feser et al. (2005) y González Villarreal et al. (2017), quienes proponen usar el estadístico de asociación espacial local de Getis-Ord (\\(G_i^*\\)) (Getis and Ord, 1992), aquí más bien se propone el uso del estadistico de asociación espacial local de Moran, propuesto originalmente por Anselin (1995) y que tiene la forma de: \\[ I_i = c \\cdot z_i \\sum_j w_{ij} z_j \\] La notación anterior corresponde a Anselin (2020), en ella \\(I_i\\) es el estadístico de asociación espacial local de Moran, \\(z_i\\) y \\(z_j\\) corresponde al valor de la variable en la unidad territorial \\(i\\) y \\(j\\), que usualmente es el empleo, en términos estandarizados, en tanto, \\(w_{ij}\\) es cada uno de los elementos de la matriz de pesos espaciales estandarizada por fila y, finalmente, \\(c\\) corresponde a una constante dada por \\(\\sum_i z_i^2\\), que no es otra cosa que la suma del valor de la variable estandarizada. El \\(I_i\\) puede ser representado en mapas de agrupaciones con cuatro categorías de municipios: i) agrupamientos de municipios con altos valores en la variable utilizada rodeados de unidades territoriales vecinas también con valores altos (agrupamientos Alto-Alto); ii) agrupamientos de unidades territoriales con valores bajos en la variable rodeados de vecinos con esta misma característica (agrupamientos Bajo-Bajo); iii) agrupamientos de unidades territoriales con valores bajos rodeados de vecinos con valores altos (agrupamientos Bajo-Alto); y iv) agrupamientos de unidades territoriales con un conteo alto de la variable de interés rodeados de municipios con un bajo conteo (agrupamientos Alto-Bajo). Cuando aquí se dece “alto” o “bajo” es en términos relativos, es decir, valores bajos o altos en el rango de la información utilizada. Las dos últimas categorías, los agrupamientos Bajo-Alto y Alto-Bajo, identifican unidades territoriales como observaciones espaciales atípicas o outliers espaciales. Para evitar sobredimensionar la importancia del empleo u ocupación en los municipios más grandes en términos de su empleo absoluto con independencia del papel que éste juegue en la cadena productiva (Feser et al., 2005, p. 403; Villarreal et al., 2017, p. 6), el índice \\(I_i\\) se construye usando como variable los errores (\\(u_i\\)) de una regresión lineal estimada con mínimos cuadrados ordinarios del empleo de cada una de las cadenas productivas en cada municipio sobre el empleo total de dicho municipio 1, es decir: \\[ emp_i=\\beta_0+\\beta_1empCPi+u_i \\] Donde \\(emp_i\\) es el empleo total del municipio \\(i\\), \\(empCPi\\) corresponde al empleo de la cadena productiva considerada en el municipio \\(i\\). El enfoque de Feser et al. (2005) y Villarreal et al. (2017) tiene algunas debilidades, mismas que a continuación se enuncian, así como una propuesta para subsanarlas en este trabajo. 3.2 Fuentes de información La base geográfica utilizada proviene del Marco Geoestadistico Nacional (INEGI, 2020a) que contiene 2,469 áreas geoestadísticas municipales (municipios), para la que se construyó una matriz de pesos espaciales de tipo reina de orden 1, en tanto, la información del personal ocupado corresponde al año 2013 y proviene de los Censos Económicos de 2019 (INEGI, 2020b). 3.3 Desarrollo del método 3.3.1 Preparación de la base de datos Para obtener los errores de la regresión lineal con base en la cual se construyen los indicadores locales de asociación espacial primero es necesario unir la información que identifica cada rama con una cadena en particular, con la información del personal ocupado total y por cadena y con la base de datos espacial. Primero se carga la base de datos con la información de los Censos Económicos que contiene los datos del personal ocupado: ce_rama2013&lt;-(read_excel(&quot;D:/Industrial_Complexes/Bases de datos/ce_rama2013.xlsx&quot;,sheet = &#39;edición&#39;)) %&gt;% filter(rama!=&quot;mun&quot;) %&gt;% dplyr::select(-nom_rama) ## Warning: Coercing text to numeric in M16828 / R16828C13: &#39;-536.877&#39; Luego, se asigna a cada rama en la base de los censos económicos la cadena productiva a la que pertenece: ce_rama2013_ci&lt;- ce_rama2013 %&gt;% left_join(ramas_ci_final, by=&#39;rama&#39;) En un siguiente paso, se pasa de una base apilada (larga) a una base ancha, lo que prepara la información para asociarla a la base de datos espacial: ce_rama2013_ci_po&lt;-ce_rama2013_ci %&gt;% filter(!is.na(po)) %&gt;% mutate(poblacion=po) %&gt;% dplyr::select(cvemun,ent,mun,rama,poblacion,po,cluster)%&gt;% pivot_wider(names_from =cluster, values_from = po) %&gt;% group_by(cvemun) %&gt;% summarise_at(c(&quot;poblacion&quot;,&quot;RC12&quot;,&quot;RC6&quot;,&quot;RC17&quot;,&quot;RC10&quot;,&quot;RC20&quot;,&quot;RC15&quot;,&quot;RC3&quot;,&quot;RC8&quot;,&quot;RC13&quot;),sum,na.rm=TRUE) %&gt;% dplyr::select(cvemun,poblacion,clusters) ## Warning: Using an external vector in selections was ## deprecated in tidyselect 1.1.0. ## ℹ Please use `all_of()` or `any_of()` instead. ## # Was: ## data %&gt;% select(clusters) ## ## # Now: ## data %&gt;% select(all_of(clusters)) ## ## See ## &lt;https://tidyselect.r-lib.org/reference/faq-external-vector.html&gt;. Se procede ahora a cargar la base de datos geográfica, es decir, la que contiene la información georreerenciada para los 2,496 municipios y a la que se asociará la información de los censos económicos: # Base geográfica municipal mun &lt;- sf::st_read(&quot;Bases de datos/shp__mun_R/mun_mex.shp&quot;) ## Reading layer `mun_mex&#39; from data source ## `D:\\guia_complejos\\Bases de datos\\shp__mun_R\\mun_mex.shp&#39; using driver `ESRI Shapefile&#39; ## Simple feature collection with 2458 features and 5 fields ## Geometry type: MULTIPOLYGON ## Dimension: XY ## Bounding box: xmin: 911292 ymin: 319149.1 xmax: 4082997 ymax: 2349615 ## Projected CRS: MEXICO_ITRF_2008_LCC names(ce_rama2013_ci_po)[1]&lt;-&#39;CVEMUN&#39; Ahora, se asocia la información espacial con la no espacial: mun_1&lt;-ce_rama2013_ci_po %&gt;% left_join(mun, by=&#39;CVEMUN&#39;) 3.3.2 Obtención de los errores del modelo de regresión Una vez cargada la base de datos espacial que contiene la información de los censos económicos, mun, se estima la regresión del empleo total de cada municipio (po) sobre el empleo en el municipio de cada una de las cadenas identificadas: mun_lm&lt;- mun_1 %&gt;% mutate( re_RC3=lm(data = mun, formula = poblacion ~ RC3)$residuals, re_RC6=lm(data = mun, formula = poblacion ~ RC6)$residuals, re_RC8=lm(data = mun, formula = poblacion ~ RC8)$residuals, re_RC10=lm(data = mun, formula = poblacion ~ RC10)$residuals, re_RC12=lm(data = mun, formula = poblacion ~ RC12)$residuals, re_RC13=lm(data = mun, formula = poblacion ~ RC13)$residuals, re_RC15=lm(data = mun, formula = poblacion ~ RC15)$residuals, re_RC17=lm(data = mun, formula = poblacion ~ RC17)$residuals, re_RC20=lm(data = mun, formula = poblacion ~ RC20)$residuals ) %&gt;% dplyr::select(everything(),-geometry,geometry) Esto añade a la base de datos espacial los errores de la regresión para poder operar con ellos. 3.3.3 Cálculo del estadístico de asociación espacial Una vez que se tienen los errores de la regresión guardados como nuevas variables en la base de datos espacial, se computa el estadístico \\(I_i\\) con dicha variable, usando la estructura espacial de tipo reina de orden 1. Para crear dicha estructura espacial se procede como: #Definición de la estructura espacial q_1 &lt;- rgeoda::queen_weights(sf::st_read(&quot;Bases de datos/shp__mun_R/mun_mex.shp&quot;)) ## Reading layer `mun_mex&#39; from data source ## `D:\\guia_complejos\\Bases de datos\\shp__mun_R\\mun_mex.shp&#39; using driver `ESRI Shapefile&#39; ## Simple feature collection with 2458 features and 5 fields ## Geometry type: MULTIPOLYGON ## Dimension: XY ## Bounding box: xmin: 911292 ymin: 319149.1 xmax: 4082997 ymax: 2349615 ## Projected CRS: MEXICO_ITRF_2008_LCC Ahora, se estima cada uno de los coeficientes de asociación espacial local de Moran y se guardan en sus respectivos objetos: #Crea un objeto de tipo LISA con la estructura espacial definida que contiene el estatistico Ii Icl3 &lt;- local_moran(w=q_1, df=mun_lm[&quot;re_RC3&quot;]) Icl6 &lt;- local_moran(w=q_1, df=mun_lm[&quot;re_RC6&quot;]) Icl8 &lt;- local_moran(w=q_1, df=mun_lm[&quot;re_RC8&quot;]) Icl10 &lt;- local_moran(w=q_1, df=mun_lm[&quot;re_RC10&quot;]) Icl12 &lt;- local_moran(w=q_1, df=mun_lm[&quot;re_RC12&quot;]) Icl13 &lt;- local_moran(w=q_1, df=mun_lm[&quot;re_RC13&quot;]) Icl15 &lt;- local_moran(w=q_1, df=mun_lm[&quot;re_RC15&quot;]) Icl17 &lt;- local_moran(w=q_1, df=mun_lm[&quot;re_RC17&quot;]) Icl20 &lt;- local_moran(w=q_1, df=mun_lm[&quot;re_RC20&quot;]) 3.3.4 Visualización de los complejos industriales: mapas de agrupamientos De acuerdo con el método, los municipios que integran los complejos industriales de cada cadena productiva identificada son aquellos cuyo valor del indicador local de asociación espacial de Moran, \\(I_i\\), es estadísticamente significativo al 5% y que además forman parte del agrupamiento Alto-Alto. Dichos municipios aparecen en los siguientes mapas de agrupamientos, junto con los municipios de las otras categorías. 3.3.4.1 Metal-mecánica mapa_funcion(mun,Icl3) 3.3.4.2 Química mapa_funcion(mun,Icl6) 3.3.4.3 Eléctrico-electrónica mapa_funcion(mun,Icl8) 3.3.4.4 Textiles, confección y prendas de vestir mapa_funcion(mun,Icl10) 3.3.4.5 Construcción mapa_funcion(mun,Icl12) 3.3.4.6 Autotransportes mapa_funcion(mun,Icl13) 3.3.4.7 Papel e impresión mapa_funcion(mun,Icl15) 3.3.4.8 Plásticos y fibras sintéticas mapa_funcion(mun,Icl17) 3.3.4.9 Muebles y productos de madera mapa_funcion(mun,Icl20) 3.3.5 Visualización de los complejos industriales: Mapas de significancia Además, es usual presentar los resultados del mapa de agrupamientos junto con el llamado mapa de significancia, que muestra la signficancia individual de cada municipio en diferentes niveles: 3.3.5.1 Metal-mecánica mapa_sig(mun,Icl3) 3.3.5.2 Química mapa_sig(mun,Icl6) 3.3.5.3 Eléctrico-electrónica mapa_sig(mun,Icl8) 3.3.5.4 Textiles, confección y prendas de vestir mapa_sig(mun,Icl10) 3.3.5.5 Construcción mapa_sig(mun,Icl12) 3.3.5.6 Autotransportes mapa_sig(mun,Icl13) 3.3.5.7 Papel e impresión mapa_sig(mun,Icl15) 3.3.5.8 Plásticos y fibras sintéticas mapa_sig(mun,Icl17) 3.3.5.9 Muebles y productos de madera mapa_sig(mun,Icl20) La siguiente tabla resume los resultados del número de municipios para cada cadena productiva, tanto los que integran los complejos industriales como los que forman parte de la categoría Alto-Bajo Tabla 1. Complejos industriales industriales, 2013 Cadena productiva Municipios alto-alto Municipios alto-bajo Metalmecánica. 71 11 Química. 63 24 Eléctrico-electrónica. 81 8 Textiles, confección y prendas de vestir 75 7 Construcción. 73 23 Autotransportes. 69 11 Papel e impresión. 79 6 Plásticos y fibras sintéticas. 64 18 Muebles y productos de madera. 59 14 "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
